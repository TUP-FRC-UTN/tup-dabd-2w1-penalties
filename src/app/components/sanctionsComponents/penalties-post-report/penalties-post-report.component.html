<section class="py-5">
    <div class="container p-3 border border-2 rounded shadow-lg">
        <form #formDenuncia="ngForm" (ngSubmit)="onSubmit()" novalidate>
            <div class="row mb-3">
                <div class="col-lg-6 mb-3">
                    <div class="row">
                        <label class="col-2 col-form-label" for="selectOption">Motivo</label>
                        <div class="col-10">
                            <select
                                [class.is-invalid]="optionField.invalid && (optionField.dirty || optionField.touched)"
                                class="form-select" id="selectOption" name="option" [(ngModel)]="selectedReasonId"
                                #optionField="ngModel" required>
                                <option value="" selected disabled="disabled">Seleccione una opci칩n</option>
                                @for (reason of reportReasons; track $index) {
                                <option [value]="reason.id">{{reason.reportReason}}</option>
                                }
                            </select>
                            <div class="invalid-feedback">
                                @if (optionField.errors?.['required']) {
                                <span>Por favor, ingrese una opci칩n</span>
                                }
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-3">
                    <div class="row">
                        <label for="dateInput" class="col-2 col-form-label">Fecha</label>
                        <div class="col-10">
                            <input type="date" id="dateInput" name="dateInput" class="form-control"
                                [(ngModel)]="dateView" #dateField="ngModel" disabled>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12 mb-3">
                    <div class="row">
                        <label for="textareaMessage" class="col-2 col-lg-1 col-form-label">Descripcion</label>
                        <div class="col-10 col-lg-11">
                            <textarea [class.is-invalid]="textArea.invalid && (textArea.dirty || textArea.touched)"
                                name="textareaMessage" id="textareaMessage" rows="8" class="form-control"
                                style="resize: none" [placeholder]="textareaPlaceholder" [(ngModel)]="description"
                                #textArea="ngModel" required minlength="10" maxlength="500"></textarea>
                            <div class="invalid-feedback">
                                @if (textArea.errors?.['required']) {
                                <span>Por favor, ingrese una descripci칩n.</span>
                                }
                                @if (textArea.errors?.['minlength']) {
                                <span>El mensaje debe tener al menos 10 caracteres.</span>
                                }
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-3">
                    <div class="row">
                        <label class="col-2 col-form-label" for="infractorInput">Infractor</label>
                        <div class="col-10">
                            <input type="text" id="infractorInput" class="form-control" placeholder="Infractor"
                                disabled>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 mb-3">
                    <div class="col-12">
                        <button type="button" class="btn btn-info" (click)="development()">Ver m치s</button>
                    </div>
                </div>

                <div class="col-lg-6 mb-3">
                    <div class="row">
                        <div class="col-2">
                        </div>
                        <div class="col-10">
                            <button type="button" class="btn btn-warning" (click)="openSelectComplaints()">Gestionar
                                denuncias <i class="bi bi-file-earmark-text"></i></button>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col d-flex justify-content-end gap-3">
                        <button type="button" class="btn btn-secondary me-3"
                            [routerLink]="'../reportList'">Cancelar</button>
                        <button type="submit" class="btn btn-success" [disabled]="formDenuncia.invalid">Crear</button>
                    </div>
                </div>

            </div>
        </form>
    </div>
</section>

<app-modal-complaints-list (selectedComplaints)="handleSelectedComplaints($event)"
    [formType]="'add'"></app-modal-complaints-list>